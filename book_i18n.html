<!DOCTYPE html>
<html lang="ko" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="page_title">ì‚´ì•„ë³¸ ë’¤ì—ì•¼ ë¹„ë¡œì†Œ ì½íˆëŠ” ë¬¸ì¥ë“¤</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- i18n ì‹œìŠ¤í…œ ë¡œë“œ -->
    <script src="js/i18n.js"></script>
    
    <script>
      // ì¸ì¦ ì²´í¬
      (function() {
        const currentUser = localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser');
        if (!currentUser) {
          window.location.href = 'index.html';
        }
      })();
    </script>
    
    <style>
      :root {
        --font-main: 'Nanum Myeongjo', serif;
        --font-sans: 'Noto Sans KR', sans-serif;
        --color-text: #1a1a1a;
        --color-heading: #000000;
        --color-accent: #5d4037;
        --color-link: #3d5afe;
        --page-width: 880px;
      }

      body {
        max-width: var(--page-width);
        margin: 0 auto;
        padding: 40px 80px;
        padding-top: 120px;
        color: var(--color-text);
        font-family: var(--font-main);
        line-height: 1.8;
        font-size: 16px;
        background-color: #ffffff;
        word-break: keep-all;
        text-align: justify;
      }

      /* ì–¸ì–´ ì„ íƒ ë©”ë‰´ */
      #language-selector {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 15px 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        z-index: 1000;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .user-info {
        color: white;
        font-family: var(--font-sans);
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .user-name {
        font-weight: 500;
      }

      .logout-btn {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 1px solid rgba(255,255,255,0.3);
        padding: 6px 16px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .logout-btn:hover {
        background: rgba(255,255,255,0.3);
        transform: translateY(-1px);
      }

      .language-links {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
      }

      .language-links a {
        color: white;
        text-decoration: none;
        padding: 6px 12px;
        border-radius: 6px;
        transition: all 0.3s ease;
        font-size: 14px;
        font-family: var(--font-sans);
        background: rgba(255,255,255,0.1);
      }

      .language-links a:hover {
        background: rgba(255,255,255,0.2);
        transform: translateY(-1px);
      }

      .language-links a.active {
        background: rgba(255,255,255,0.3);
        font-weight: 600;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      }

      .divider {
        color: rgba(255,255,255,0.4);
        margin: 0 4px;
      }

      /* Loading indicator */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255,255,255,0.95);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
      }

      .loading-overlay.active {
        display: flex;
      }

      .loading-content {
        text-align: center;
      }

      .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* Typography */
      h1 { font-size: 2.4em; color: var(--color-heading); margin: 1.5em 0 0.8em; }
      h2 { font-size: 1.8em; color: var(--color-heading); border-bottom: 2px solid #eee; padding-bottom: 0.3em; margin: 1.3em 0 0.6em; }
      h3 { font-size: 1.4em; color: var(--color-heading); margin: 1.2em 0 0.5em; }
      
      .cover-page {
        min-height: 80vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        margin-bottom: 3em;
      }

      .cover-title {
        font-size: 3.5em;
        font-weight: 700;
        color: var(--color-heading);
        margin-bottom: 0.5em;
        line-height: 1.3;
      }

      .cover-subtitle {
        font-size: 1.3em;
        color: var(--color-accent);
        margin-bottom: 2em;
        font-family: var(--font-sans);
      }

      .cover-author {
        font-size: 1.1em;
        color: #666;
        font-family: var(--font-sans);
      }

      @media (max-width: 768px) {
        body { padding: 20px; padding-top: 140px; }
        #language-selector { flex-direction: column; gap: 10px; padding: 10px; }
        .language-links { justify-content: center; }
        .cover-title { font-size: 2.2em; }
      }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p data-i18n="loading_translation">ë²ˆì—­ ì¤‘...</p>
        </div>
    </div>

    <!-- Language Selector -->
    <div id="language-selector">
        <div class="user-info">
            <span class="user-name" id="userName">ì‚¬ìš©ì</span>
            <button class="logout-btn" onclick="logout()" data-i18n="logout">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
        
        <div class="language-links">
            <a href="javascript:void(0)" onclick="switchLanguage('ar')" data-lang="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('zh-CN')" data-lang="zh-CN">ä¸­æ–‡</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('en')" data-lang="en">English</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('fr')" data-lang="fr">FranÃ§ais</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('ru')" data-lang="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('es')" data-lang="es">EspaÃ±ol</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('ja')" data-lang="ja">æ—¥æœ¬èª</a>
            <span class="divider">|</span>
            <a href="javascript:void(0)" onclick="switchLanguage('ko')" data-lang="ko" class="active">í•œêµ­ì–´</a>
        </div>
    </div>

    <!-- Cover Page -->
    <div class="cover-page">
        <div class="cover-title" data-i18n="book_title">
            ì‚´ì•„ë³¸ ë’¤ì—ì•¼<br>ë¹„ë¡œì†Œ ì½íˆëŠ”<br>ë¬¸ì¥ë“¤
        </div>
        <div class="cover-subtitle">
            <span data-i18n="book_subtitle">Lines Life Taught Me</span>
        </div>
        <div class="cover-author">
            <span data-i18n="author">ê°•ë¦¼ì„ ìƒ ì§€ìŒ</span>
        </div>
    </div>

    <!-- Main Content -->
    <main>
        <h2 data-i18n="section_opening">ì—¬ëŠ” ë§</h2>
        <p data-i18n="opening_text">
            ì´ ì±…ì€ ì¸ìƒì˜ ì§€í˜œë¥¼ ë‹´ì€ 99ê°€ì§€ ë¬¸ì¥ë“¤ì„ ì†Œê°œí•©ë‹ˆë‹¤. 
            ì‚´ë©´ì„œ ê²½í—˜í•˜ê²Œ ë˜ëŠ” ë‹¤ì–‘í•œ ìƒí™©ì—ì„œ ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ í†µì°°ì„ ì œê³µí•©ë‹ˆë‹¤.
        </p>

        <h2 data-i18n="part1_title">ì œ1ë¶€. ê²½ì œì™€ ê±°ë˜ì˜ ë²•ì¹™</h2>
        
        <h3 data-i18n="chapter1_title">1. ì„¸ìƒì— ê³µì§œëŠ” ì—†ë‹¤</h3>
        <p data-i18n="chapter1_text">
            ëª¨ë“  ê²ƒì—ëŠ” ëŒ€ê°€ê°€ ìˆìŠµë‹ˆë‹¤. ê³µì§œì²˜ëŸ¼ ë³´ì´ëŠ” ê²ƒë„ ì–´ë”˜ê°€ì—ì„œ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ê³  ìˆìŠµë‹ˆë‹¤.
        </p>

        <h3 data-i18n="chapter2_title">2. í•˜ì´ ë¦¬ìŠ¤í¬, í•˜ì´ ë¦¬í„´</h3>
        <p data-i18n="chapter2_text">
            í° ì´ìµì„ ì–»ìœ¼ë ¤ë©´ í° ìœ„í—˜ì„ ê°ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤. íˆ¬ìì™€ ì¸ìƒì˜ ê¸°ë³¸ ì›ì¹™ì…ë‹ˆë‹¤.
        </p>

        <div style="text-align: center; margin: 60px 0; color: #999; font-style: italic;">
            <p data-i18n="content_omitted">â€» ì œ3~99ì¥ ìƒëµ â€»</p>
        </div>

        <h2 data-i18n="section_closing">ë§ºìŒ ë§</h2>
        <p data-i18n="closing_text">
            ì´ ë¬¸ì¥ë“¤ì´ ì—¬ëŸ¬ë¶„ì˜ ì‚¶ì— ì‘ì€ ì§€í˜œë¥¼ ë”í•˜ê¸¸ ë°”ëë‹ˆë‹¤. 
            ì¸ìƒì€ ê²½í—˜ì„ í†µí•´ ë°°ìš°ëŠ” ê²ƒì´ë©°, ì´ ë¬¸ì¥ë“¤ì´ ê·¸ ê²½í—˜ì„ ì´í•´í•˜ëŠ” ë° ë„ì›€ì´ ë˜ê¸°ë¥¼ ë°”ëë‹ˆë‹¤.
        </p>
    </main>

    <script>
        // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
        function displayUserInfo() {
            const currentUser = localStorage.getItem('currentUser') || sessionStorage.getItem('currentUser');
            if (currentUser) {
                try {
                    const user = JSON.parse(currentUser);
                    document.getElementById('userName').textContent = user.name || 'ê²ŒìŠ¤íŠ¸';
                } catch (e) {
                    document.getElementById('userName').textContent = 'ê²ŒìŠ¤íŠ¸';
                }
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('currentUser');
                sessionStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        }

        // ì–¸ì–´ ì „í™˜ (i18n ì‚¬ìš©)
        async function switchLanguage(lang) {
            console.log('ğŸ”„ ì–¸ì–´ ì „í™˜ ì‹œë„:', lang);
            
            // ë¡œë”© í‘œì‹œ
            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.classList.add('active');
            
            try {
                // i18nì„ ì‚¬ìš©í•˜ì—¬ ì–¸ì–´ ì „í™˜
                const success = await window.i18n.switchLanguage(lang);
                
                if (success) {
                    // í™œì„± ì–¸ì–´ ë©”ë‰´ ì—…ë°ì´íŠ¸
                    updateActiveLanguage(lang);
                    console.log('âœ… ì–¸ì–´ ì „í™˜ ì™„ë£Œ:', lang);
                } else {
                    console.error('âŒ ì–¸ì–´ ì „í™˜ ì‹¤íŒ¨:', lang);
                    alert('ë²ˆì—­ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
            } catch (error) {
                console.error('âŒ ì–¸ì–´ ì „í™˜ ì˜¤ë¥˜:', error);
                alert('ë²ˆì—­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            } finally {
                // ë¡œë”© ìˆ¨ê¹€
                setTimeout(() => {
                    loadingOverlay.classList.remove('active');
                }, 500);
            }
        }

        // í™œì„± ì–¸ì–´ ë©”ë‰´ ì—…ë°ì´íŠ¸
        function updateActiveLanguage(lang) {
            const links = document.querySelectorAll('.language-links a');
            links.forEach(link => {
                if (link.getAttribute('data-lang') === lang) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ“– í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            displayUserInfo();
            
            // i18n ì´ˆê¸°í™” ì™„ë£Œ ëŒ€ê¸°
            const checkI18n = setInterval(() => {
                if (window.i18n) {
                    console.log('âœ… i18n ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ');
                    clearInterval(checkI18n);
                    
                    // í˜„ì¬ ì–¸ì–´ë¡œ í™œì„± ë©”ë‰´ ì—…ë°ì´íŠ¸
                    const currentLang = window.i18n.getCurrentLanguage();
                    updateActiveLanguage(currentLang);
                }
            }, 100);
        });
    </script>
</body>
</html>
